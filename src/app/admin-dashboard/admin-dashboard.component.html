<div class="container mt-4">
  <h2 class="text-center mb-4">Dashboard Amministratore</h2>

  <!-- Pulsante per nuovo incarico -->
  <div class="text-end mb-3">
    <button class="btn btn-primary" (click)="openNewTask()">
      + Nuovo Incarico
    </button>
  </div>

  <!-- Form per nuovo incarico (nascosto per default) -->
  <div class="card" *ngIf="showNewTaskForm">
    <div class="card-header bg-primary text-white">
      Nuovo Incarico
    </div>
    <div class="card-body">
      <form (ngSubmit)="createTask()" #taskForm="ngForm">

        <!-- Cliente -->
        <div class="mb-3">
          <label class="form-label">Nome Cliente</label>
          <input type="text" class="form-control" [(ngModel)]="newTask.clientName" name="clientName" required>
        </div>

        <!-- Volo -->
        <div class="row mb-3">
          <div class="col-md-6">
            <label class="form-label">Volo</label>
            <input type="text" class="form-control" [(ngModel)]="newTask.flight" name="flight">
          </div>
          <div class="col-md-6">
            <label class="form-label">Orario Arrivo</label>
            <input type="time" class="form-control" [(ngModel)]="newTask.arrivalTime" name="arrivalTime" required>
          </div>
        </div>

        <!-- Hotel -->
        <div class="mb-3">
          <label class="form-label">Hotel</label>
          <input type="text" class="form-control" [(ngModel)]="newTask.hotel" name="hotel" required>
        </div>

        <!-- Indirizzo Hotel -->
        <div class="mb-3">
          <label class="form-label">Indirizzo Hotel</label>
          <input type="text" class="form-control" [(ngModel)]="newTask.hotelAddress" name="hotelAddress" required>
        </div>

        <!-- Operatore -->
        <div class="mb-3">
          <label class="form-label">Assegna Operatore</label>
          <select class="form-select" [(ngModel)]="newTask.operatorId" name="operatorId" required>
            <option value="">Seleziona operatore</option>
            <option *ngFor="let op of operators" [value]="op.id">{{ op.name }}</option>
          </select>
        </div>

        <!-- Pulsanti -->
        <div class="d-flex justify-content-end">
          <button type="button" class="btn btn-secondary me-2" (click)="cancelTask()">Annulla</button>
          <button type="submit" class="btn btn-success" [disabled]="!taskForm.form.valid">Assegna e Invia</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Lista incarichi -->
  <div class="table-responsive">
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Cliente</th>
          <th>Volo</th>
          <th>Arrivo</th>
          <th>Hotel</th>
          <th>Operatore</th>
          <th>Stato</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let task of tasks">
          <td>{{ task.clientName }}</td>
          <td>{{ task.flight }}</td>
          <td>{{ task.arrivalTime }}</td>
          <td>{{ task.hotel }}</td>
          <td>{{ getOperatorName(task.operatorId) }}</td>
          <td><span class="badge bg-warning">Assegnato</span></td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
